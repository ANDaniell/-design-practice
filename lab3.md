#![Диаграммы_вариантов_использования-Собственный кинотеатр drawio (2)](https://github.com/user-attachments/assets/64283eb7-7360-4e30-b2c3-d8f5c9782cf2)
## Описание

1. **Акторы:**
    
    - **Админ** – пользователь с правами управления системой.
    - **Гость** – пользователь, который может взаимодействовать с функциями выбора и покупки билетов без необходимости авторизации.
2. **Основные варианты использования:**
    
    - **Админ:**
        
        - **CRUD фильм**: администратор может создавать, читать, обновлять и удалять записи о фильмах в системе.
        - **CRUD сеанс**: администратор управляет сеансами (создает, редактирует, удаляет).
    - **Гость:**
        
        - **Выбрать фильм**: поиск и выбор фильма для получения информации о нем.
            - **Расширение (`<<extend>>`)**:
                - **Ознакомиться с информацией о фильме**: получение описания, актеров, рейтинга.
                - **Ознакомиться с информацией о сеансах**: просмотр доступных сеансов для выбранного фильма.
        - **Купить билет**: процесс покупки билета.
            - **Включает (`<<include>>`)**:
                - **Выбрать сеанс**: выбор подходящего сеанса для просмотра.
                - **Выбрать места**: выбор свободных мест в зале для бронирования.
            - **Альтернативы:**
                - **Купить оффлайн**: возможность указать, что билет будет куплен на кассе кинотеатра.
                - **Купить онлайн**: процесс оплаты билета через систему.

---

### Детали сценариев:

1. **Админ:**
    
    - Выполняет операции управления данными о фильмах и сеансах. Это необходимо для актуальности каталога фильмов и расписания.
2. **Гость:**
    
    - **Выбрать фильм**:  
        Гость может найти интересующий фильм и получить о нем информацию, включая доступные сеансы.
    - **Купить билет:**  
        Основной процесс, включающий:
        - Выбор сеанса и мест в зале.
        - Возможность завершить покупку онлайн или зарегистрировать покупку как оффлайн, если оплата будет произведена в кассе.

---

### Связи и зависимости:

1. **`<<extend>>`:**
    
    - Дополнительные действия, такие как просмотр информации о фильме или сеансах, расширяют основной сценарий выбора фильма. Эти действия необязательны, но полезны для пользователя.
2. **`<<include>>`:**
    
    - Выбор сеанса и мест обязателен для выполнения сценария покупки билета, так как они являются частью логического процесса бронирования.
  
---

**Вариант использования:** «Купить билет в онлайн-кинотеатре»  
**Описание:** Пользователь хочет приобрести билет на выбранный сеанс в онлайн-кинотеатре.  
**Предусловие:** Пользователь авторизован в системе и находится на странице выбора сеансов.

### Основной сценарий:
---
1. **Пользователь выбирает фильм из списка доступных.**
   
	- **Клиент:** Отправляет запрос на сервер для получения доступных сеансов.
    - **Сервер:**
        - Запрашивает список сеансов из базы данных.
        - Возвращает данные о доступных сеансах, включая дату, время и статус бронирования мест.
2. **Пользователь выбирает место.**
   
	- **Клиент:** Отправляет запрос на сервер с идентификатором выбранного сеанса.
    - **Сервер:**
        - Проверяет доступность мест в базе данных.
        - Возвращает карту зала с актуальным статусом мест (свободно/занято).
3. **Пользователь подтверждает выбор места.**
    
	- **Клиент:** Отправляет запрос на сервер с идентификатором сеанса и местом для предварительного бронирования.
    - **Сервер:**
        - Проверяет, что место доступно.
        - Создает временную запись в таблице бронирования с состоянием "в ожидании оплаты" и временным интервалом на завершение платежа.
        - Возвращает успешный ответ клиенту.
4. **Пользователь переходит к оплате.**
    
    - **Клиент:** Отправляет запрос на сервер для получения платежной формы.
    - **Сервер:**
        - Генерирует платежный токен через интеграцию с платежным провайдером.
        - Возвращает платежный шлюз клиенту.
5. **Пользователь вводит данные карты и завершает оплату.**
    
    - **Клиент:** Перенаправляет пользователя на страницу платежного провайдера.
    - **Сервер платежного провайдера:** Обрабатывает запрос, отправляет уведомление на сервер кинотеатра о статусе платежа.
6. **Сервер кинотеатра обрабатывает уведомление о платеже.**

    - **Платежный провайдер:** Отправляет запрос на сервер кинотеатра с результатом платежа.
    - **Сервер кинотеатра:**
        - Проверяет корректность данных уведомления (хэш, идентификатор транзакции, сумма).
        - Обновляет статус бронирования:
            - **Если оплата успешна:**
                - Меняет статус на «оплачено».
                - Изменяем поля билета, убираем его из доступных в сессии.
                - Сохраняем билет в таблице билетов кассы и отправляем пользователю.
            - **Если оплата неуспешна:**
                - Меняет статус на «истекло».
                - Освобождает место в таблице бронирования.
7. **Пользователь получает результат.**
    
    - **Клиент:** Отправляет запрос на сервер для проверки статуса бронирования .
    - **Сервер:**
        - Возвращает итоговый статус бронирования и, если оплата успешна, ссылку на билет.

---

### Альтернативный сценарий 1:

- Если пользователь не завершает оплату в течение установленного времени (например, 15 минут), сервер выполняет автоматическую отмену временного бронирования с помощью фоновой задачи.

### Альтернативный сценарий 2:

- Если пользователь хочет оплатить другим способом (например, через мобильный кошелек), он выбирает соответствующую опцию на шаге 4, после чего система перенаправляет его на страницу выбранного метода оплаты.

### Альтернативный сценарий 3: Пользователь отменяет выбор места до оплаты

1. Пользователь выбирает место и отправляет запрос на сервер для предварительного бронирования.
2. После этого пользователь решает отменить выбор места до завершения оплаты.
    - **Клиент:** Отправляет запрос на сервер для отмены бронирования.
    - **Сервер:**
        - Проверяет статус бронирования.
        - Обновляет его в базе данных на «отменено».
        - Освобождает место, возвращая его в доступные для других пользователей.

---

### Альтернативный сценарий 4: Сбой на стороне платежного провайдера

1. Пользователь переходит к оплате, вводит данные карты и подтверждает платеж.
2. Платежный провайдер возвращает сообщение об ошибке (например, проблемы с сетью или банковским шлюзом).
    - **Сервер кинотеатра:** Получает уведомление о неуспешной транзакции от провайдера.
        - Обновляет статус бронирования на «в ожидании».
        - Уведомляет клиента о необходимости повторить попытку оплаты.
3. Пользователь возвращается к шагу 4 основного сценария (выбор способа оплаты).

---

### Альтернативный сценарий 5: Место стало недоступно до подтверждения бронирования

1. Пользователь выбирает место в зале и отправляет запрос на сервер для предварительного бронирования.
2. Сервер проверяет статус места в базе данных и обнаруживает, что оно уже было забронировано другим пользователем.
    - **Сервер:** Возвращает ошибку с сообщением «Место недоступно» и обновленные данные о свободных местах в зале.
3. Пользователь выбирает другое место, повторяя шаг 2 основного сценария.


## Goodwin cinema
![Диаграммы_вариантов_использования-Goodwin Cinema drawio (1)](https://github.com/user-attachments/assets/7708740c-8b45-4536-ac5e-11058b64fd57)
### Общая структура

1. **Акторы:**
    
    - **Гость** – пользователь, который может взаимодействовать с ограниченными функциями системы без авторизации.
    - **Клиент** – зарегистрированный пользователь, имеющий доступ к расширенным функциям, связанным с оплатой и предзаказом билетов.
2. **Основные варианты использования:**
    
    - **Найти фильм**: поиск интересующего фильма.
        - Расширение (`<<extend>>`):
            - **Ознакомиться с отзывами пользователей**: позволяет увидеть мнения других зрителей.
            - **Прочитать рецензии**: просмотр профессиональных или пользовательских рецензий.
            - **Оценить рейтинг**: пользователь видит общий рейтинг фильма.
    - **Просмотреть информацию о фильме**: позволяет ознакомиться с подробным описанием фильма, включая жанр, актеров и продолжительность.
    - **Выбрать сеанс**: базовая функциональность, необходимая для бронирования билетов. Это включено (`<<include>>`) в сценарий оплаты.
    - **Оплатить билет**: функциональность доступна только для клиента (зарегистрированного пользователя).
        - Расширение (`<<extend>>`):
            - **Сделать предзаказ**: возможность бронирования билетов заранее.

---

### Связь акторов с функциональностью:

- **Гость**:
    
    - Может искать фильмы, просматривать их информацию, отзывы, рецензии и рейтинг.
    - Не имеет доступа к оплате или выбору сеансов.
- **Клиент (зарегистрированный пользователь)**:
    
    - Имеет доступ к тем же функциям, что и гость.
    - Дополнительно может выбирать сеанс, оплачивать билеты и делать предзаказы.

---

### Примечания:

- Варианты использования с меткой `<<extend>>` указывают на необязательные функции, которые расширяют основной сценарий. Например, при поиске фильма пользователь может, но не обязан, просматривать отзывы.
- Варианты использования с меткой `<<include>>` указывают на обязательную часть функциональности. Например, для оплаты билета необходимо сначала выбрать сеанс.


## FAKEL
![Диаграммы_вариантов_использования-Fakel drawio](https://github.com/user-attachments/assets/a4ee2043-2a6c-4057-89ca-e49cdf1c0d3d)
### Общая структура

1. **Акторы:**
    
    - **Гость** — неавторизованный пользователь с ограниченным доступом к функциям системы.
    - **Клиент (зарегистрированный пользователь)** — имеет доступ к дополнительным возможностям, таким как предзаказ, оплата билетов и написание отзывов.
2. **Основные варианты использования:**
    
    - **Посмотреть предложения:**
        - Включает (`<<include>>`):
            - **Посмотреть анонсы:** просмотр предстоящих фильмов.
            - **Посмотреть афишу:** актуальная информация о фильмах, доступных к просмотру.
            - **Просмотреть информацию о фильме:** получение подробных сведений о конкретном фильме.
            - **Просмотреть репертуар:** расписание текущих сеансов.
    - **Найти фильм:** поиск конкретного фильма по заданным критериям.
        - Расширение (`<<extend>>`):
            - **Ознакомиться с отзывами пользователей:** доступ к пользовательским отзывам.
            - **Прочитать рецензии:** чтение профессиональных и пользовательских обзоров.
            - **Оценить рейтинг:** просмотр и оценка рейтинга фильма.
    - **Выбрать сеанс:** базовый шаг перед покупкой билета или предзаказом.
    - **Посмотреть игры:** вероятно, относится к разделу с дополнительными активностями или мини-играми на сайте кинотеатра.
    - **Оплатить билет:**
        - Включает (`<<include>>`): **Выбрать сеанс**.
        - Расширение (`<<extend>>`): **Сделать предзаказ:** возможность предварительного бронирования.
    - **Написать отзыв:** доступно только зарегистрированным пользователям.

---

### Взаимодействия и зависимости

1. **`<<include>>`:**
    
    - Эти зависимости указывают, что для выполнения сценария необходимо выполнение связанного действия. Например, чтобы «посмотреть предложения», нужно получить доступ к анонсам, афише, информации о фильме и репертуару.
2. **`<<extend>>`:**
    
    - Эти зависимости описывают необязательные действия, которые могут быть выполнены в рамках основного сценария. Например, при поиске фильма пользователь может дополнительно ознакомиться с отзывами, рецензиями или рейтингом.

---

### Функциональность по типу пользователей:

1. **Гость:**
    
    - Может взаимодействовать с базовыми функциями, такими как просмотр анонсов, афиши, информации о фильмах и репертуара, выбор сеансов и поиск фильмов.
    - Не имеет доступа к действиям, связанным с оплатой билетов, предзаказами или написанием отзывов.
2. **Клиент (зарегистрированный пользователь):**
    
    - Помимо функциональности гостя, имеет доступ к следующим возможностям:
        - **Сделать предзаказ**.
        - **Оплатить билет**.
        - **Написать отзыв**.

---

**Итог:** Диаграмма иллюстрирует ключевые процессы, доступные гостям и клиентам, выделяя различия в их правах и возможностях. Это помогает определить функциональные требования к системе и разграничить роли пользователей.

